<!DOCTYPE html>
<html>
<head>
  <title>Select Show</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    body{
      font-family:'Inter',sans-serif;
      background:#f1f5f9;
      margin:0;
      padding-top: 40px;
    }

    .container{
      max-width:1000px;
      margin:auto;
    }
        .footer {
      background: #0f172a;
      color: #cbd5f5;
      padding: 40px 60px;
      
    }

    .footer-container {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 40px;
    }

    .footer h3,
    .footer h4 {
      color: #38bdf8;
    }

    .footer a {
      color: #cbd5f5;
      text-decoration: none;
    }

    .footer a:hover {
      color: #38bdf8;
    }
    /* MOVIE HEADER */

    .movie-header{
      display:flex;
      gap:25px;
      background:white;
      padding:25px;
      border-radius:12px;
      box-shadow:0 8px 20px rgba(0,0,0,0.08);
      align-items:center;
    }

    .poster{
      width:160px;
      border-radius:10px;
    }

    .movie-title{
      font-size:28px;
      font-weight:600;
      margin-bottom:6px;
    }

    .meta{
      color:#475569;
      margin-bottom:5px;
      font-size:14px;
    }

    .date{
      margin:30px 0 15px;
      font-size:18px;
      font-weight:600;
    }

    /* THEATRE CARD */

    .theatre-card{
      background:white;
      padding:18px;
      margin-bottom:18px;
      border-radius:10px;
      box-shadow:0 2px 6px rgba(0,0,0,0.05);
    }

    .theatre-name{
      font-weight:600;
      margin-bottom:12px;
      font-size:16px;
    }

    .timings{
      display:flex;
      gap:12px;
      flex-wrap:wrap;
    }

    .show-btn{
      padding:10px 18px;
      border:1px solid #2563eb;
      background:#eff6ff;
      color:#2563eb;
      border-radius:6px;
      cursor:pointer;
      transition:0.2s;
      font-weight:500;
    }

    .show-btn:hover{
      background:#2563eb;
      color:white;
    }

  </style>
</head>

<body>

<div class="container">

  <div class="movie-header">
    <img id="poster" class="poster">
    <div>
      <div id="movieTitle" class="movie-title"></div>
      <div id="director" class="meta"></div>
      <div id="cast" class="meta"></div>
    </div>
  </div>

  <div id="shows"></div>

</div>

<script>

const params = new URLSearchParams(window.location.search);
const movieId = params.get("movie_id");
const title = params.get("title");

document.getElementById("movieTitle").innerText = title;

fetch(`../backend/get_movies.php?id=${movieId}`)
.then(res=>res.json())
.then(movie=>{
    if(movie.poster){
        document.getElementById("poster").src="../"+movie.poster;
    }
    document.getElementById("director").innerText="Director: "+(movie.director || "NA");
    document.getElementById("cast").innerText="Cast: "+(movie.cast_members || "NA");
});

fetch(`../backend/get_shows.php?movie_id=${movieId}`)
.then(res=>res.json())
.then(data=>{

    const container=document.getElementById("shows");
    container.innerHTML="";

    if(data.length===0){
        container.innerHTML="No shows available";
        return;
    }

    const dateDiv=document.createElement("div");
    dateDiv.className="date";
    dateDiv.innerText="Date: "+data[0].show_date;
    container.appendChild(dateDiv);

    const grouped={};

    data.forEach(show=>{
        if(!grouped[show.theatre_name]){
            grouped[show.theatre_name]=[];
        }
        grouped[show.theatre_name].push(show);
    });

    Object.keys(grouped).forEach(theatre=>{
        const card=document.createElement("div");
        card.className="theatre-card";

        const name=document.createElement("div");
        name.className="theatre-name";
        name.innerText=theatre;

        const row=document.createElement("div");
        row.className="timings";

        grouped[theatre].forEach(show=>{
            const btn=document.createElement("button");
            btn.className="show-btn";
            btn.innerText=show.show_time;
            btn.onclick=()=>{
              window.location.href=`seats.html?show_id=${show.id}&movie_id=${movieId}`;
            };
            row.appendChild(btn);
        });

        card.appendChild(name);
        card.appendChild(row);
        container.appendChild(card);
    });

});
</script>

</body>
<footer class="footer">
    <div class="footer-container">

        <div>
            <h3>Movie-Dekh</h3>
            <p>Book tickets instantly. Fast, secure and simple.</p>
        </div>

        <div>
            <h4>Quick Links</h4>
            <p><a href="index.html">Home</a></p>
            <p><a href="my_bookings.html">My Bookings</a></p>
        </div>

        <div>
            <h4>Contact</h4>
            <p>Email: support@moviedekh.com</p>
            <p>Phone: +91 9876543210</p>
        </div>

    </div>

    <div class="copyright">
        &copy 2026 Movie-Dekh. All rights reserved.
    </div>
</footer>
</html>
